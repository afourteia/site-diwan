---
// Use Vite/ASTRO base URL so redirects and canonical links respect `base`.
const rawBase = import.meta.env.BASE_URL ?? '';
const baseForClient = rawBase === '' || rawBase === '/' ? './' : rawBase.endsWith('/') ? rawBase : rawBase + '/';
---
<!-- Redirect root based on browser language. Default: Arabic (`/ar/`). -->
<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="robots" content="noindex" />
		<link rel="canonical" href={baseForClient + 'ar/'} />
		<base href={baseForClient} />
		<title>Redirectingâ€¦</title>
		<script>
			(function () {
				const defaultLang = 'ar';
				const supported = ['ar', 'en'];
				const raw = navigator.languages || [navigator.language || ''];
				function pick(list: readonly string[]) {
					for (const l of list) {
						if (!l) continue;
						const code = l.split('-')[0].toLowerCase();
						if (supported.includes(code)) return code;
					}
					return defaultLang;
				}
				try {
					const lang = pick(raw);
					const baseEl = document.querySelector('base') as HTMLBaseElement | null;
					const base = baseEl?.getAttribute('href') || '/';
					const target = base + lang + '/';
					if (location.pathname !== target) location.replace(target);
				} catch (e) {
					const baseEl = document.querySelector('base') as HTMLBaseElement | null;
					const base = baseEl?.getAttribute('href') || '/';
					location.replace(base + 'ar/');
				}
			})();
		</script>
		<noscript>
			<meta http-equiv="refresh" content={"0;url=" + (baseForClient + 'ar/')} />
		</noscript>
	</head>
	<body>
		<p><a href={baseForClient + 'ar/'}>Redirecting to {baseForClient + 'ar/'}</a></p>
	</body>
</html>
 
